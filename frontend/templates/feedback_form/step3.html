{% extends 'base.html' %}
{% load staticfiles %}

{% block head %}
<script type="text/javascript" src="{% static 'dropzone.js' %}"></script>
<link rel="stylesheet" type="text/css" href="{% static 'dropzone.css' %}">
{% endblock %}

{% block content %}
{% include 'feedback_form/stagebar.html' with stage=wizard.steps.step1%}
<form method="post" class="form-horizontal" enctype="multipart/form-data">
{% csrf_token %}
{{ wizard.management_form }}
	<div class="form-group">
		<label for="{{form.title.id_for_label}}" class="col-sm-2 control-label">Otsikko:</label>
		<div class="col-sm-8">
			{{form.title}}
		</div>
	</div>
	<div class="form-group">
		<label for="{{form.description.id_for_label}}" class="col-sm-2 control-label">Kuvaus:</label>
		<div class="col-sm-8">
			{{form.description}}
		</div>
	</div>
	<div class="form-group">
		<span class="col-sm-offset-2 col-sm-4 col-xs-4" id="char_counter">5000 merkkiä jäljellä</span>
		<div class="col-sm-offset-2 col-sm-2 col-xs-offset-4 col-xs-4">
			<button type="submit" class="btn btn-primary pull-right">Seuraava <span class="glyphicon glyphicon-triangle-right"></span></button>
		</div>
	</div>
</form>
<form class="dropzone" action="{% url 'media_upload' %}" id="dropzone">
	{% csrf_token %}
</form>
{{form.errors}}
<script>
$(function () {
	$("#{{form.description.id_for_label}}").keyup(function() {
	  var text_length = $('#{{form.description.id_for_label}}').val().length;
	  var text_remaining = 5000 - text_length;
	  $('#char_counter').text(text_remaining + " merkkiä jäljellä");
	});

	Dropzone.options.dropzone = {
		url: "{% url 'media_upload' %}"
	};

	Dropzone.options.dropzone = {
	  init: function() {
	    this.on("success", function(file) { console.log("Added a file ", file.name); });
	  }
	};

});
</script>
{% include 'footer.html' %}
{% endblock %}